{% load tz %}
<div class="border border-gray-200 dark:border-slate-700 rounded-lg p-4 shadow-sm hover:border-blue-300 dark:hover:border-blue-500 transition-all duration-300 preference-card bg-white dark:bg-slate-800" data-id="{{ preference.id }}" data-label="{{ preference.label|escape }}">
    <div class="flex items-start justify-between gap-2">
        <div>
            <h3 class="text-base font-semibold text-gray-900 dark:text-white transition-colors duration-200">{{ preference.label }}</h3>
            <p class="text-xs text-gray-500 dark:text-slate-400 transition-colors duration-200">Terakhir diperbarui {{ preference.updated_at|timezone:"Asia/Jakarta"|date:"d M Y H:i" }} WIB</p>
        </div>
        <div class="flex flex-col items-end gap-1 text-xs">
            <span class="px-2 py-1 rounded-full bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300 uppercase font-bold transition-colors duration-200">{{ preference.get_default_scope_display }}</span>
            {% if preference.is_private %}
                <span class="px-2 py-1 rounded-full bg-gray-200 text-gray-700 dark:bg-slate-700 dark:text-slate-300 uppercase font-bold transition-colors duration-200">Pribadi</span>
            {% elif preference.is_staff_only %}
                <span class="px-2 py-1 rounded-full bg-purple-100 text-purple-700 dark:bg-purple-900/40 dark:text-purple-300 uppercase font-bold transition-colors duration-200">Staf</span>
            {% endif %}
            {% if preference.only_discount %}
                <span class="px-2 py-1 rounded-full bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-300 uppercase font-bold transition-colors duration-200">Diskon</span>
            {% endif %}
        </div>
    </div>
    {% if preference.description %}
        <p class="text-sm text-gray-600 dark:text-slate-400 mt-3 transition-colors duration-200">{{ preference.description }}</p>
    {% endif %}
    <ul class="mt-3 space-y-1 text-sm text-gray-600 dark:text-slate-400 transition-colors duration-200">
        {% if preference.default_news_category %}
            <li>• Fokus berita: <span class="text-gray-900 dark:text-slate-200">{{ preference.default_news_category.nama }}</span></li>
        {% endif %}
        {% if preference.default_product_category %}
            <li>• Kategori produk: <span class="text-gray-900 dark:text-slate-200">{{ preference.default_product_category.name }}</span></li>
        {% endif %}
        {% if preference.default_brand %}
            <li>• Brand favorit: <span class="text-gray-900 dark:text-slate-200">{{ preference.default_brand.name }}</span></li>
        {% endif %}
        {% if preference.min_price or preference.max_price %}
            <li>• Rentang harga: <span class="text-gray-900 dark:text-slate-200">{{ preference.min_price|default:"0" }} - {{ preference.max_price|default:"∞" }}</span></li>
        {% endif %}
    </ul>
    <div class="flex items-center justify-between mt-4 border-t border-gray-100 dark:border-slate-700 pt-4 transition-colors duration-300">
        <button type="button" class="text-sm text-blue-600 dark:text-blue-400 font-bold hover:underline apply-preference" data-id="{{ preference.id }}">Gunakan preset</button>
        {% if request.user.is_authenticated and preference.user == request.user %}
            <div class="flex items-center gap-3 text-sm">
                <span class="text-gray-400 dark:text-slate-500 text-xs">Privasi: {{ preference.get_role_visibility_display }}</span>
                <button type="button" class="text-gray-600 dark:text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 font-medium edit-preference" data-id="{{ preference.id }}">Edit</button>
                <button type="button" class="text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 font-medium delete-preference" data-id="{{ preference.id }}">Hapus</button>
            </div>
        {% else %}
            <span class="text-xs text-gray-400 dark:text-slate-500 italic">Dibuat oleh {{ preference.user.username }}</span>
        {% endif %}
    </div>
</div>
